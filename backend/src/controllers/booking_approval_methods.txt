  // Approve booking (owner only)
  static async approveBooking(req, res) {
    try {
      const { id } = req.params;
      const { owner_id } = req.body;

      // Check if booking exists
      const booking = await Booking.findById(id)
        .populate('venue', 'name owner')
        .populate('organizer', 'name email');

      if (!booking) {
        return res.status(404).json({
          message: 'Booking not found'
        });
      }

      // Check if booking is pending
      if (booking.status !== 'pending') {
        return res.status(400).json({
          message: 'Only pending bookings can be approved'
        });
      }

      // Verify the user is the venue owner
      if (booking.venue.owner.toString() !== owner_id) {
        return res.status(403).json({
          message: 'Only the venue owner can approve bookings'
        });
      }

      // Update booking status
      booking.status = 'approved';
      booking.approvedBy = owner_id;
      booking.approvedAt = new Date();

      await booking.save();

      res.json({
        message: 'Booking approved successfully',
        booking: booking
      });
    } catch (error) {
      console.error('Error approving booking:', error);
      res.status(500).json({
        message: 'Error approving booking',
        error: error.message
      });
    }
  }

  // Reject booking (owner only)
  static async rejectBooking(req, res) {
    try {
      const { id } = req.params;
      const { owner_id, rejection_reason } = req.body;

      // Check if booking exists
      const booking = await Booking.findById(id)
        .populate('venue', 'name owner')
        .populate('organizer', 'name email');

      if (!booking) {
        return res.status(404).json({
          message: 'Booking not found'
        });
      }

      // Check if booking is pending
      if (booking.status !== 'pending') {
        return res.status(400).json({
          message: 'Only pending bookings can be rejected'
        });
      }

      // Verify the user is the venue owner
      if (booking.venue.owner.toString() !== owner_id) {
        return res.status(403).json({
          message: 'Only the venue owner can reject bookings'
        });
      }

      // Update booking status
      booking.status = 'rejected';
      if (rejection_reason) {
        booking.notes = `${booking.notes}\n\nRejection reason: ${rejection_reason}`;
      }

      await booking.save();

      res.json({
        message: 'Booking rejected successfully',
        booking: booking
      });
    } catch (error) {
      console.error('Error rejecting booking:', error);
      res.status(500).json({
        message: 'Error rejecting booking',
        error: error.message
      });
    }
  }
